{"version":3,"file":"reactjs-popup.js","sources":["../src/Utils.js","../src/Popup.js"],"sourcesContent":["/* Algo to calculate position \n  1. center position for popup content : the center of the trigger will be the center of the content content\n      so the popup content position will be like this :\n      top => the y of the center for the trigger element : trigger.top + trigger.height/2\n      left => the x of the center for the trigger element : trigger.left + trigger.width/2\n\n  2. translate position according to the first  position attribute  passed  in the function argument \n      for example :\n        position = 'left top'\n        we need to handle the first argument in the position: 'left' => that's mean we need to translate the popup content according to the X axis by - content.width/2\n      \n  3.translate position according to the first  position attribute  passed  in the function argument \n    for example :\n      position = 'left top'\n      the second argument 'top' => translate popup content by + content.height*4/5\n\n*/\n\nexport default function calculatePosition(\n  triggerBounding,\n  ContentBounding,\n  position\n) {\n  const style = {};\n  const margin = 5;\n  const args = position.split(\",\");\n  // the 1 step : center the popup content => ok\n  const CenterTop = triggerBounding.top + triggerBounding.height / 2;\n  const CenterLeft = triggerBounding.left + triggerBounding.width / 2;\n  const { height, width } = ContentBounding;\n  let top = CenterTop - height / 2;\n  let left = CenterLeft - width / 2;\n  let transform = \"\";\n  let arrowTop = \"0%\";\n  let arrowLeft = \"0%\";\n  // the 2 step : => ok\n  switch (args[0]) {\n    case \"top\":\n      top -= height / 2 + triggerBounding.height / 2 + margin;\n      transform = `translateX(-50%) rotate(45deg)`;\n      arrowTop = \"100%\";\n      arrowLeft = \"50%\";\n      break;\n    case \"bottom\":\n      top += height / 2 + triggerBounding.height / 2 + margin;\n      transform = `translateX(-50%) rotate(225deg)`;\n      arrowLeft = \"50%\";\n      break;\n    case \"left\":\n      left -= width / 2 + triggerBounding.width / 2 + margin;\n      transform = ` translateY(-50%) rotate(-45deg)`;\n      arrowLeft = \"100%\";\n      arrowTop = \"50%\";\n      break;\n    case \"right\":\n      left += width / 2 + triggerBounding.width / 2 + margin;\n      transform = `translateY(-50%) rotate(135deg)`;\n      arrowTop = \"50%\";\n\n      break;\n  }\n  switch (args[1]) {\n    case \"top\":\n      top += height / 4;\n      arrowTop = \"25%\";\n      break;\n    case \"bottom\":\n      top -= height / 4;\n      arrowTop = \"75%\";\n      break;\n    case \"left\":\n      left += width / 4;\n      arrowLeft = \"25%\";\n      break;\n    case \"right\":\n      left -= width / 4;\n      arrowLeft = \"75%\";\n      break;\n  }\n\n  return { top, left, transform, arrowLeft, arrowTop };\n}\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport calculatePosition from \"./Utils\";\n\nexport default class Popup extends React.Component {\n  static defaultProps = {\n    closeOnDocumentClick: false,\n    defaultOpen: false,\n    triggerOn: \"click\",\n    style: {},\n    className: \"\",\n    position: \"bottom,center\"\n  };\n  state = {\n    isOpen: this.props.defaultOpen\n  };\n  timeOut = 0;\n\n  constructor(props) {\n    super(props);\n    this.setTriggerRef = r => (this.TriggerEl = r);\n    this.setContentRef = r => (this.ContentEl = r);\n    this.setArrowRef = r => (this.ArrowEl = r);\n  }\n\n  togglePopup = () => {\n    this.setState(\n      prevState => ({\n        isOpen: !prevState.isOpen\n      }),\n      () => this.state.isOpen && this.setPosition()\n    );\n  };\n  openPopup = () => {\n    this.setState({ isOpen: true }, () => this.setPosition());\n  };\n  closePopup = () => {\n    this.setState({ isOpen: false });\n  };\n  onMouseEnter = () => {\n    clearTimeout(this.timeOut);\n    this.openPopup();\n  };\n  onMouseLeave = () => {\n    clearTimeout(this.timeOut);\n    this.timeOut = setTimeout(() => this.closePopup(), 300);\n  };\n\n  setPosition = () => {\n    const trigger = this.TriggerEl.getBoundingClientRect();\n    const content = this.ContentEl.getBoundingClientRect();\n    const cords = calculatePosition(trigger, content, this.props.position);\n    this.ContentEl.style.top = cords.top + \"px\";\n    this.ContentEl.style.left = cords.left + \"px\";\n    this.ArrowEl.style.transform = cords.transform;\n    this.ArrowEl.style.top = cords.arrowTop;\n    this.ArrowEl.style.left = cords.arrowLeft;\n  };\n\n  renderTrigger = () => {\n    const triggerProps = {};\n    const triggerOn = this.props.triggerOn || \"click\";\n    triggerProps.ref = this.setTriggerRef;\n    switch (triggerOn) {\n      case \"click\":\n        triggerProps.onClick = this.togglePopup;\n        break;\n      case \"hover\":\n        triggerProps.onMouseEnter = this.onMouseEnter;\n        triggerProps.onMouseLeave = this.onMouseLeave;\n        break;\n    }\n    return React.cloneElement(this.props.trigger, triggerProps);\n  };\n\n  addWarperAction = () => {\n    const childrenElementProps = {\n      className: `popup-content  ${this.props.className}`,\n      style: Object.assign({ position: \"fixed\" }, this.props.style),\n      ref: this.setContentRef,\n      onClick: e => e.stopPropagation()\n    };\n    if (this.props.triggerOn === \"hover\") {\n      childrenElementProps.onMouseEnter = this.onMouseEnter;\n      childrenElementProps.onMouseLeave = this.onMouseLeave;\n    }\n    return childrenElementProps;\n  };\n\n  render() {\n    return (\n      <React.Fragment>\n        {this.renderTrigger()}\n        {this.state.isOpen && (\n          <div\n            className=\"overlay\"\n            onClick={\n              this.props.closeOnDocumentClick ? this.closePopup : undefined\n            }\n          >\n            <div {...this.addWarperAction()}>\n              <div ref={this.setArrowRef} className=\"popup-arrow\" />\n              {typeof this.props.children === \"function\"\n                ? this.props.children(this.state.isOpen, this.closePopup)\n                : this.props.children}\n            </div>\n          </div>\n        )}\n      </React.Fragment>\n    );\n  }\n}\n\nPopup.propTypes = {\n  style: PropTypes.object,\n  className: PropTypes.string,\n  children: PropTypes.oneOf([\n    PropTypes.func,\n    PropTypes.element,\n    PropTypes.string\n  ]),\n  closeOnDocumentClick: PropTypes.bool,\n  triggerOn: PropTypes.oneOf([\"hover\", \"click\"]),\n  position: PropTypes.oneOf([\n    \"top,left\",\n    \"top,center\",\n    \"top,right\",\n    \"bottom,left\",\n    \"bottom,center\",\n    \"bottom,right\",\n    \"right,top\",\n    \"right,center\",\n    \"right,bottom\",\n    \"left,top\",\n    \"left,center\",\n    \"left,bottom\"\n  ])\n};\n"],"names":["calculatePosition","triggerBounding","ContentBounding","position","margin","args","split","CenterTop","top","height","CenterLeft","left","width","transform","arrowTop","arrowLeft","Popup","props","state","defaultOpen","timeOut","togglePopup","setState","prevState","isOpen","setPosition","openPopup","closePopup","onMouseEnter","onMouseLeave","setTimeout","trigger","TriggerEl","getBoundingClientRect","content","ContentEl","cords","style","ArrowEl","renderTrigger","triggerProps","triggerOn","ref","setTriggerRef","onClick","React","cloneElement","addWarperAction","childrenElementProps","className","Object","assign","setContentRef","e","stopPropagation","r","setArrowRef","closeOnDocumentClick","undefined","children","Component","defaultProps","propTypes","PropTypes","object","string","oneOf","func","element","bool"],"mappings":"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"}